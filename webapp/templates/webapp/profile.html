{% extends './base.html' %}

{% block title %}Личный кабинет{% endblock %}

{% block head %}
<script>
    $().ready( function () {
        $('.nav-tabs').find('button').on('click', function (e) {
            e.preventDefault();
            $($(this).attr('data-bs-target')).tab('show');
        });
    });
</script>
{% endblock %}

{% block content %}
    <ul class="nav nav-tabs" id="tabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="true">Профиль</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="orders-tab" data-bs-toggle="tab" data-bs-target="#orders" type="button" role="tab" aria-controls="orders" aria-selected="false">Заказы</button>
        </li>
    </ul>
    <div class="tab-content" id="tabsContent">
        <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            <h2>Обновить данные профиля</h2>
            <form method="POST">
                {% csrf_token %}
                <table>
                    {{ form.as_table }}
                </table>
                <button type="submit">Обновить</button>
            </form>
        </div>
        <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
            <h2>История заказов</h2>
            <div>
                {% for item in orders %}
                    <div>
                        {{item.order.registration_date}}: {{ item.order.description }} -> {{ item.order.get_status_display }}
                        <ol>
                        {% for product in item.products %}
                            <li><div>{{ product.product.get_material_display }}, {{ product.product.get_use_type_display }} - {{ product.product.price }}</div></li>
                        {% endfor %}
                        </ol>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    
    
{% endblock %}
